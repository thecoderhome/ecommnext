(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{46:function(e,s,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/placeorder",function(){return i(5859)}])},1836:function(e,s,i){"use strict";i.d(s,{Z:function(){return t}});var r=i(5893);function t(e){let{activeStep:s=0}=e;return(0,r.jsx)("div",{className:"mb-5 flex flex-wrap",children:["UserLogin","Shipping Address","Payment Method","Place Order"].map((e,i)=>(0,r.jsx)("div",{className:"flex-1 border-b-2 text-center ".concat(i<=s?"border-indigo-500 text-indigo-500":"border-gray-400 text-gray-400"),children:e},e))})}i(7294)},3399:function(e,s,i){"use strict";i.d(s,{Z:function(){return u}});var r=i(5893),t=i(7294),n=i(2920);i(7134);var l=i(5746),c=i(9008),a=i.n(c),d=i(1664),h=i.n(d),x=i(2148),o=i(3299);function m(e){let{href:s,children:i,...t}=e;return(0,r.jsx)(h(),{href:s,legacyBehavior:!0,children:(0,r.jsx)("a",{...t,children:i})})}var j=i(1955);function u(e){let{title:s,children:i}=e,{status:c,data:d}=(0,o.useSession)(),{state:u,dispatch:f}=(0,t.useContext)(x.y),{cart:{cartItems:p}}=u,[v,g]=(0,t.useState)(0);(0,t.useEffect)(()=>{g(p.reduce((e,s)=>e+s.quantity,0))},[p]);let N=()=>{j.Z.remove("cart"),f("CART_RESET"),(0,o.signOut)({callbackUrl:"/login"})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a(),{children:[(0,r.jsx)("title",{children:s?"".concat(s," - EVSHOP"):"EVSHOP"}),(0,r.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(n.Ix,{position:"bottom-center",limit:1}),(0,r.jsxs)("div",{className:"flex min-h-screen flex-col justify-between",children:[(0,r.jsx)("header",{children:(0,r.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[(0,r.jsx)(h(),{href:"/",legacyBehavior:!0,children:(0,r.jsx)("a",{className:"text-lg font-bold",children:"EVSHOP"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h(),{href:"/cart",legacyBehavior:!0,children:(0,r.jsxs)("a",{className:"p-2",children:["Cart",v>0&&(0,r.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:v})]})}),"loading"===c?"Loading":(null==d?void 0:d.user)?(0,r.jsxs)(l.v,{as:"div",className:"relative inline-block",children:[(0,r.jsx)(l.v.Button,{className:"text-blue-600",children:d.user.name}),(0,r.jsxs)(l.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-white shadow-lg",children:[(0,r.jsx)(l.v.Item,{children:(0,r.jsx)(m,{className:"dropdown-link",href:"/profile",children:"Profile"})}),(0,r.jsx)(l.v.Item,{children:(0,r.jsx)(m,{className:"dropdown-link",href:"/order-history",children:"Order History"})}),(0,r.jsx)(l.v.Item,{children:(0,r.jsx)("a",{className:"dropdown-link",href:"#",onClick:N,children:"Logout"})})]})]}):(0,r.jsx)(h(),{href:"/login",legacyBehavior:!0,children:(0,r.jsx)("a",{className:"p-2",children:"Login"})})]})]})}),(0,r.jsx)("main",{className:"container m-auto mt-4 px-4",children:i}),(0,r.jsx)("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:"Copyright \xa92023 EVSHOP"})]})]})}},5859:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return p}});var r=i(5893),t=i(1836),n=i(3399),l=i(5738),c=i(2148),a=i(8433),d=i(1955),h=i(5675),x=i.n(h),o=i(1664),m=i.n(o),j=i(1163),u=i(7294),f=i(2920);function p(){let{state:e,dispatch:s}=(0,u.useContext)(c.y),{cart:i}=e,{cartItems:h,shippingAddress:o,paymentMethod:p}=i,v=(0,j.useRouter)(),g=e=>Math.round(100*e+Number.EPSILON)/100,N=g(h.reduce((e,s)=>e+s.quantity*s.price,0)),b=N>200?0:15,y=g(.15*N),w=g(N+b+y),[E,O]=(0,u.useState)(!1);(0,u.useEffect)(()=>{p||v.push("/payment")},[]);let S=async()=>{try{O(!0);let{data:e}=await a.Z.post("/api/orders",{orderItems:h,shippingAddress:o,paymentMethod:p,itemsPrice:N,shippingPrice:b,taxPrice:y,totalPrice:w});O(!1),s({type:"CART_CLEAR_ITEMS"}),d.Z.set("cart",JSON.stringify({...i,cartItems:[]})),v.push("/order/".concat(e._id))}catch(e){O(!1),f.Am.error((0,l.b)(e))}};return(0,r.jsxs)(n.Z,{title:"Place Order",children:[(0,r.jsx)(t.Z,{activeStep:3}),(0,r.jsx)("h1",{className:"mb-4 text-xl",children:"Place Order"}),0===h.length?(0,r.jsxs)("div",{children:["Cart is empty. ",(0,r.jsx)(m(),{href:"/",children:"Go shopping"})]}):(0,r.jsxs)("div",{className:"grid md:grid-cols-4 md:gap-5",children:[(0,r.jsxs)("div",{className:"overflow-x-auto md:col-span-3",children:[(0,r.jsxs)("div",{className:"card p-5",children:[(0,r.jsx)("h2",{className:"mb-2 text-lg",children:"Shipping Address"}),(0,r.jsxs)("div",{children:[o.fullName,", ",o.address,",",o.city,", ",o.postalCode,",",o.country]}),(0,r.jsx)("div",{children:(0,r.jsx)(m(),{href:"/shipping",children:"Edit"})})]}),(0,r.jsxs)("div",{className:"card p-5",children:[(0,r.jsx)("h2",{className:"mb-2 text-lg",children:"Payment Method"}),(0,r.jsx)("div",{children:p}),(0,r.jsx)("div",{children:(0,r.jsx)(m(),{href:"/payment",children:"Edit"})})]}),(0,r.jsxs)("div",{className:"card overflow-x-auto p-5",children:[(0,r.jsx)("h2",{className:"mb-2 text-lg",children:"Order Items"}),(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{className:"border-b",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-5 text-left",children:"Item"}),(0,r.jsx)("th",{className:"p-5 text-right",children:"Quantity"}),(0,r.jsx)("th",{className:"p-5 text-right",children:"Price"}),(0,r.jsx)("th",{className:"p-5",children:"Action"})]})}),(0,r.jsx)("tbody",{children:h.map(e=>(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("td",{children:(0,r.jsx)(m(),{href:"/product/".concat(e.slug),legacyBehavior:!0,children:(0,r.jsxs)("a",{className:"items flex-center",children:[(0,r.jsx)(x(),{src:e.image,alt:e.name,width:50,height:50}),"\xa0",e.name]})})}),(0,r.jsx)("td",{className:"p-5 text-right",children:e.quantity}),(0,r.jsx)("td",{className:"p-5 text-right",children:e.price}),(0,r.jsx)("td",{className:"p-5 text-right",children:e.quantity*e.price})]},e.slug))})]}),(0,r.jsx)("div",{children:(0,r.jsx)(m(),{href:"/cart",children:"Edit"})})]})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"card p-5",children:[(0,r.jsx)("h",{className:"mb-2 text-lg",children:"Order Summary"}),(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)("div",{children:"Items"}),(0,r.jsx)("div",{children:N})]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)("div",{children:"Tax"}),(0,r.jsx)("div",{children:y})]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)("div",{children:"Shipping"}),(0,r.jsx)("div",{children:b})]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)("div",{children:"Total"}),(0,r.jsx)("div",{children:w})]})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{disabled:E,onClick:S,className:"primary-button w-full",children:E?"...Loading":"Place Order"})})]})]})})]})]})}p.auth=!0},5738:function(e,s,i){"use strict";i.d(s,{b:function(){return r}});let r=e=>{e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message}}},function(e){e.O(0,[329,433,675,774,888,179],function(){return e(e.s=46)}),_N_E=e.O()}]);